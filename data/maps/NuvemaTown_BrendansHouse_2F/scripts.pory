raw `
.set LOCALID_STARTERS, 1
.set LOCALID_CHEREN, 2
.set LOCALID_BIANCA, 3

NuvemaTown_BrendansHouse_2F_MapScripts::
	map_script MAP_SCRIPT_ON_TRANSITION, NuvemaTown_BrendansHouse_2F_OnTransition
	map_script MAP_SCRIPT_ON_FRAME_TABLE, NuvemaTown_BrendansHouse_2F_OnFrame
	map_script MAP_SCRIPT_ON_WARP_INTO_MAP_TABLE, NuvemaTown_BrendansHouse_2F_OnWarp
	.byte 0

NuvemaTown_BrendansHouse_2F_OnTransition:
	call_if_lt VAR_NUVEMA_RIVAL_STATE, 2, NuvemaTown_BrendansHouse_2F_EventScript_CheckSetReadyToMeetBrendan
	call_if_ge VAR_NUVEMA_RIVAL_STATE, 3, NuvemaTown_BrendansHouse_2F_EventScript_CheckShouldUpdateBrendanPos
	call_if_eq VAR_NUVEMA_INTRO_STATE, 4, PlayersHouse_2F_EventScript_BlockStairsUntilClockIsSet
	call SecretBase_EventScript_SetDecorationFlags
	setvar VAR_SECRET_BASE_INITIALIZED, 0
	end

NuvemaTown_BrendansHouse_2F_EventScript_CheckShouldUpdateBrendanPos::
	goto_if_set FLAG_MET_RIVAL_LILYCOVE, NuvemaTown_BrendansHouse_2F_EventScript_TryUpdateBrendanPos
	goto_if_ge VAR_BIRCH_LAB_STATE, 2, NuvemaTown_BrendansHouse_2F_EventScript_Ret
	goto NuvemaTown_BrendansHouse_2F_EventScript_TryUpdateBrendanPos

NuvemaTown_BrendansHouse_2F_EventScript_TryUpdateBrendanPos::
	checkplayergender
	goto_if_eq VAR_RESULT, MALE, NuvemaTown_BrendansHouse_2F_EventScript_Ret
	@ Odd that the MaysHouse equivalent was used below instead
	goto_if_ge VAR_DEX_UPGRADE_JOHTO_STARTER_STATE, 2, NuvemaTown_MaysHouse_2F_EventScript_Ret
	setobjectxyperm LOCALID_RIVAL, 0, 2
	setobjectmovementtype LOCALID_RIVAL, MOVEMENT_TYPE_FACE_UP
	return

NuvemaTown_BrendansHouse_2F_EventScript_Ret::
	return

NuvemaTown_BrendansHouse_2F_EventScript_CheckSetReadyToMeetBrendan::
	checkplayergender
	goto_if_eq VAR_RESULT, FEMALE, NuvemaTown_BrendansHouse_2F_EventScript_SetReadyToMeetBrendan
	return

NuvemaTown_BrendansHouse_2F_EventScript_SetReadyToMeetBrendan::
	setvar VAR_NUVEMA_RIVAL_STATE, 2
	return

NuvemaTown_BrendansHouse_2F_OnFrame:
	map_script_2 VAR_NUVEMA_TOWN_STATE, 1, NuvemaTown_BrendansHouse_2F_EventScript_IntroCutscene
	.2byte 0

NuvemaTown_BrendansHouse_2F_OnWarp:
    call NuvemaTown_BrendansHouse_2F_EventScript_IntroCutscene
	map_script_2 VAR_SECRET_BASE_INITIALIZED, 0, NuvemaTown_BrendansHouse_2F_EventScript_CheckInitDecor
	.2byte 0

NuvemaTown_BrendansHouse_2F_EventScript_CheckInitDecor::
	checkplayergender
	goto_if_eq VAR_RESULT, MALE, SecretBase_EventScript_InitDecorations
	end

NuvemaTown_BrendansHouse_2F_EventScript_RivalsPokeBall::
	lockall
	goto_if_eq VAR_NUVEMA_RIVAL_STATE, 2, NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendan
	msgbox RivalsHouse_2F_Text_ItsRivalsPokeBall, MSGBOX_DEFAULT
	releaseall
	end

NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendan::
	delay 10
	addobject LOCALID_RIVAL
	applymovement LOCALID_RIVAL, NuvemaTown_BrendansHouse_2F_Movement_BrendanEnters
	waitmovement 0
	playse SE_PIN
	applymovement LOCALID_RIVAL, Common_Movement_ExclamationMark
	waitmovement 0
	applymovement LOCALID_RIVAL, Common_Movement_Delay48
	waitmovement 0
	delay 10
	playbgm MUS_ENCOUNTER_BRENDAN, TRUE
	call_if_eq VAR_FACING, DIR_NORTH, NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendanNorth
	call_if_eq VAR_FACING, DIR_SOUTH, NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendanSouth
	call_if_eq VAR_FACING, DIR_WEST, NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendanWest
	call_if_eq VAR_FACING, DIR_EAST, NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendanEast
	setvar VAR_NUVEMA_RIVAL_STATE, 3
	setflag FLAG_HIDE_NUVEMA_TOWN_BRENDANS_HOUSE_2F_POKE_BALL
	clearflag FLAG_HIDE_NUVEMA_TOWN_BRENDANS_HOUSE_RIVAL_BEDROOM
	setvar VAR_NUVEMA_TOWN_STATE, 1
	savebgm MUS_DUMMY
	fadedefaultbgm
	releaseall
	end

NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendanNorth::
	applymovement LOCALID_RIVAL, NuvemaTown_BrendansHouse_2F_Movement_BrendanApproachPlayerNorth
	waitmovement 0
	applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterRight
	waitmovement 0
	msgbox RivalsHouse_2F_Text_BrendanWhoAreYou, MSGBOX_DEFAULT
	closemessage
	applymovement OBJ_EVENT_ID_PLAYER, NuvemaTown_BrendansHouse_2F_Movement_PlayerWatchBrendanNorth
	applymovement LOCALID_RIVAL, NuvemaTown_BrendansHouse_2F_Movement_BrendanWalkToPCNorth
	waitmovement 0
	return

NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendanSouth::
	applymovement LOCALID_RIVAL, NuvemaTown_BrendansHouse_2F_Movement_BrendanApproachPlayerSouth
	waitmovement 0
	applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterRight
	waitmovement 0
	msgbox RivalsHouse_2F_Text_BrendanWhoAreYou, MSGBOX_DEFAULT
	closemessage
	applymovement OBJ_EVENT_ID_PLAYER, NuvemaTown_BrendansHouse_2F_Movement_PlayerWatchBrendanSouth
	applymovement LOCALID_RIVAL, NuvemaTown_BrendansHouse_2F_Movement_BrendanWalkToPCSouth
	waitmovement 0
	return

NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendanWest::
	applymovement LOCALID_RIVAL, NuvemaTown_BrendansHouse_2F_Movement_BrendanApproachPlayerWest
	waitmovement 0
	applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterRight
	waitmovement 0
	msgbox RivalsHouse_2F_Text_BrendanWhoAreYou, MSGBOX_DEFAULT
	closemessage
	applymovement OBJ_EVENT_ID_PLAYER, NuvemaTown_BrendansHouse_2F_Movement_PlayerWatchBrendanWest
	applymovement LOCALID_RIVAL, NuvemaTown_BrendansHouse_2F_Movement_BrendanWalkToPCWest
	waitmovement 0
	return

NuvemaTown_BrendansHouse_2F_EventScript_MeetBrendanEast::
	applymovement LOCALID_RIVAL, NuvemaTown_BrendansHouse_2F_Movement_BrendanApproachPlayerEast
	waitmovement 0
	applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterUp
	waitmovement 0
	msgbox RivalsHouse_2F_Text_BrendanWhoAreYou, MSGBOX_DEFAULT
	closemessage
	applymovement LOCALID_RIVAL, NuvemaTown_BrendansHouse_2F_Movement_BrendanWalkToPCEast
	waitmovement 0
	return

NuvemaTown_BrendansHouse_2F_Movement_BrendanEnters:
	walk_down
	walk_down
	walk_in_place_faster_left
	step_end

NuvemaTown_BrendansHouse_2F_Movement_BrendanApproachPlayerNorth:
	walk_left
	walk_left
	walk_down
	walk_down
	walk_left
	step_end

NuvemaTown_BrendansHouse_2F_Movement_BrendanWalkToPCNorth:
	walk_up
	walk_up
	walk_up
	walk_left
	walk_left
	walk_left
	walk_left
	walk_in_place_faster_up
	step_end

NuvemaTown_BrendansHouse_2F_Movement_PlayerWatchBrendanNorth:
	delay_16
	walk_in_place_faster_up
	delay_16
	delay_16
	delay_16
	delay_16
	walk_in_place_faster_left
	step_end

NuvemaTown_BrendansHouse_2F_Movement_BrendanApproachPlayerSouth:
	walk_left
	walk_left
	walk_left
	step_end

NuvemaTown_BrendansHouse_2F_Movement_BrendanWalkToPCSouth:
	walk_up
	walk_left
	walk_left
	walk_left
	walk_left
	walk_in_place_faster_up
	step_end

NuvemaTown_BrendansHouse_2F_Movement_PlayerWatchBrendanSouth:
	delay_16
	walk_in_place_faster_up
	delay_16
	delay_16
	walk_in_place_faster_left
	step_end

NuvemaTown_BrendansHouse_2F_Movement_BrendanApproachPlayerWest:
	walk_left
	walk_left
	walk_down
	walk_in_place_faster_left
	step_end

NuvemaTown_BrendansHouse_2F_Movement_BrendanWalkToPCWest:
	walk_up
	walk_up
	walk_left
	walk_left
	walk_left
	walk_left
	walk_left
	walk_in_place_faster_up
	step_end

NuvemaTown_BrendansHouse_2F_Movement_PlayerWatchBrendanWest:
	delay_8
	delay_16
	walk_in_place_faster_up
	delay_16
	delay_16
	walk_in_place_faster_left
	step_end

NuvemaTown_BrendansHouse_2F_Movement_BrendanApproachPlayerEast:
	walk_left
	walk_left
	walk_left
	walk_left
	walk_left
	walk_in_place_faster_down
	step_end

NuvemaTown_BrendansHouse_2F_Movement_BrendanWalkToPCEast:
	walk_up
	walk_left
	walk_left
	walk_in_place_faster_up
	step_end

@ Unused, the player is already facing this direction so its unneeded
NuvemaTown_BrendansHouse_2F_Movement_PlayerWatchBrendanEast:
	delay_16
	delay_16
	walk_in_place_faster_left
	step_end

NuvemaTown_BrendansHouse_2F_EventScript_PC::
	lockall
	checkplayergender
	goto_if_eq VAR_RESULT, MALE, NuvemaTown_BrendansHouse_2F_EventScript_CheckPlayersPC
	goto_if_eq VAR_RESULT, FEMALE, NuvemaTown_BrendansHouse_2F_EventScript_CheckRivalsPC
	end

NuvemaTown_BrendansHouse_2F_EventScript_CheckPlayersPC::
	setvar VAR_0x8004, PC_LOCATION_BRENDANS_HOUSE
	special DoPCTurnOnEffect
	playse SE_PC_ON
	msgbox gText_PlayerHouseBootPC, MSGBOX_DEFAULT
	special BedroomPC
	waitstate
	releaseall
	end

NuvemaTown_BrendansHouse_2F_EventScript_TurnOffPlayerPC::
	setvar VAR_0x8004, PC_LOCATION_BRENDANS_HOUSE
	playse SE_PC_OFF
	special DoPCTurnOffEffect
	releaseall
	end

NuvemaTown_BrendansHouse_2F_EventScript_CheckRivalsPC::
	msgbox gText_PokemonTrainerSchoolEmail, MSGBOX_DEFAULT
	releaseall
	end

PlayersHouse_2F_EventScript_Notebook::
	msgbox PlayersHouse_2F_Text_Notebook, MSGBOX_SIGN
	end

PlayersHouse_2F_EventScript_GameCube::
	msgbox PlayersHouse_2F_Text_ItsAGameCube, MSGBOX_SIGN
	end

PlayersHouse_2F_Text_ClockIsStopped:
	.string "The clock is stopped…\p"
	.string "Better set it and start it!$"

PlayersHouse_2F_Text_HowDoYouLikeYourRoom:
	.string "MOM: {PLAYER}, how do you like your\n"
	.string "new room?\p"
	.string "Good! Everything's put away neatly!\p"
	.string "They finished moving everything in\n"
	.string "downstairs, too.\p"
	.string "POKéMON movers are so convenient!\p"
	.string "Oh, you should make sure that\n"
	.string "everything's all there on your desk.$"

PlayersHouse_2F_Text_Notebook:
	.string "{PLAYER} flipped open the notebook.\p"
	.string "ADVENTURE RULE NO. 1\n"
	.string "Open the MENU with START.\p"
	.string "ADVENTURE RULE NO. 2\n"
	.string "Record your progress with SAVE.\p"
	.string "The remaining pages are blank…$"

Common_Text_LookCloserAtMap:
	.string "{PLAYER} took a closer look at the\n"
	.string "UNOVA region map.$"

PlayersHouse_2F_Text_ItsAGameCube:
	.string "It's a Nintendo GameCube.\p"
	.string "A Game Boy Advance is connected to\n"
	.string "serve as the Controller.$"
`

script NuvemaTown_BrendansHouse_2F_EventScript_IntroCutscene {
	lockall
	applymovement(LOCALID_CHEREN, Cheren_Approaches)
	waitmovement(0)
    msgbox(Cheren_Intro)
	call(PlayersHouse_2F_EventScript_SetWallClock)
	setflag(FLAG_SET_WALL_CLOCK)
	setvar(VAR_NUVEMA_TOWN_STATE,2)
    addobject(LOCALID_BIANCA)
	applymovement(LOCALID_BIANCA, Bianca_Climbs_Stairs)
	waitmovement(0)
    msgbox(Bianca_Arrives)
	applymovement(LOCALID_CHEREN, Cheren_Meets_Bianca)
	waitmovement(0)
    msgbox(Cheren_Berating)
	applymovement(LOCALID_BIANCA, Bianca_Enters)
	waitmovement(0)
	applymovement(LOCALID_CHEREN, Cheren_Faces_Group)
	waitmovement(0)
	applymovement(OBJ_EVENT_ID_PLAYER, Player_Faces_Group)
	waitmovement(0)
    msgbox(Bianca_Apology)
	applymovement(LOCALID_BIANCA, Bianca_Approaches_Starters)
	waitmovement(0)
	applymovement(OBJ_EVENT_ID_PLAYER, Player_Faces_Bianca)
	waitmovement(0)
    msgbox(Bianca_TimeToPick)
	msgbox(Cheren_Response)
	applymovement(LOCALID_CHEREN, Cheren_Approaches_Starters)
	waitmovement(0)
	applymovement(OBJ_EVENT_ID_PLAYER, Player_Faces_Starters)
	waitmovement(0)
    msgbox(Cheren_TimeToPick)
	releaseall
}

script NuvemaTown_BrendansHouse_2F_EventScript_StarterBag {
	lockall
	setflag(FLAG_SYS_POKEMON_GET)
	fadescreen(FADE_TO_BLACK)
	special(ChooseStarter)
	setflag(FLAG_SYS_POKEDEX_GET)
	special(SetUnlockedPokedexFlags)
	setflag(FLAG_RECEIVED_POKEDEX_FROM_BIRCH)
	releaseall
}

movement Cheren_Approaches {
    walk_down * 1
	face_left
}

text Cheren_Intro{
	format("Cheren: {PLAYER}! I heard from Professor Juniper. We can have a Pokémon?\N...\N...\NWhat's keeping Bianca? What time is it anyways?")
}

movement Bianca_Climbs_Stairs{
    walk_down * 1
}

text Bianca_Arrives{
    format("Bianca: Am I a little late again? So-oooo-orry!")
}

movement Cheren_Meets_Bianca{
    walk_right * 1
	walk_up * 1
}

text Cheren_Berating{
    format("Cheren: Bianca... I've known for ten years that you have no sense of time, but...seriously... Today's the day we can get a Pokémon from Professor Juniper!")
}

movement Bianca_Enters{
    walk_down * 1
	walk_left * 4
	walk_down * 1
}

movement Cheren_Faces_Group{
	face_player
}

movement Player_Faces_Group{
	face_up
}

text Bianca_Apology{
    format("Bianca: I know. Sorry, {PLAYER}. Sorry, Cheren.")
}

movement Bianca_Approaches_Starters{
	walk_left * 1
	walk_down * 2
	face_player
}

movement Player_Faces_Bianca{
	face_left
}

text Bianca_TimeToPick{
    format("Bianca: So, where are the Pokémon? They were delivered to Player's house, so {PLAYER} gets first pick.")
}

text Cheren_Response{
    format("Cheren: Naturally.")
}

movement Cheren_Approaches_Starters{
	walk_left * 1
	walk_down * 1
}

movement Player_Faces_Starters{
	face_down
}

text Cheren_TimeToPick{
    format("The Pokémon are waiting for us inside that gift box. Ok, {PLAYER}, you go first and take a peek at the gift box. I want to meet the Pokémon right now!")
}